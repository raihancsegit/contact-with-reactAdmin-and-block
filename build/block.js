!function(){"use strict";var e=window.wp.element,t=window.wp.blocks,n=window.wp.components,a=window.wp.blockEditor;const l=["Fishing","Running","Reading","Cooking","Traveling","Gardening"];var o=({hobbies:t,setHobbies:n})=>{const[a,o]=(0,e.useState)(""),[c,s]=(0,e.useState)(l),[r,i]=(0,e.useState)(-1),[u,m]=(0,e.useState)(!1),d=(0,e.useRef)(null),p=(0,e.useRef)(null);return(0,e.useEffect)((()=>{s(l.filter((e=>e.toLowerCase().includes(a.toLowerCase())&&!t.includes(e))))}),[a,t]),(0,e.useEffect)((()=>{const e=e=>{d.current&&!d.current.contains(e.target)&&p.current&&!p.current.contains(e.target)&&m(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]),(0,e.createElement)("div",{className:"tag-list-container"},(0,e.createElement)("div",{className:"tag-list"},t.map(((t,a)=>(0,e.createElement)("span",{key:a},t,(0,e.createElement)("button",{type:"button",onClick:()=>(e=>{n((t=>t.filter(((t,n)=>n!==e))))})(a),"aria-label":`Remove ${t}`},"x"))))),(0,e.createElement)("input",{className:"tag-list-input",value:a,onChange:e=>{o(e.target.value),m(!0),i(-1)},onKeyDown:e=>{"Enter"===e.key?(a&&(n((e=>[...e,a.charAt(0).toUpperCase()+a.slice(1)])),o(""),m(!1)),e.preventDefault()):"Backspace"===e.key?""===a&&t.length&&n((e=>e.slice(0,-1))):"ArrowDown"===e.key?i((e=>Math.min(c.length-1,e+1))):"ArrowUp"===e.key?i((e=>Math.max(-1,e-1))):"Enter"===e.key&&r>=0&&(n((e=>[...e,c[r]])),o(""),m(!1),i(-1))},placeholder:"Add a hobby",ref:d,onClick:()=>m(!0)}),u&&c.length>0&&(0,e.createElement)("ul",{className:"tag-list-dropdown",ref:p},c.map(((t,a)=>(0,e.createElement)("li",{key:a,onClick:()=>(e=>{n((t=>[...t,e])),o(""),m(!1)})(t),style:{backgroundColor:r===a?"#d0d0d0":"transparent"},onMouseEnter:()=>i(a)},t)))))};(0,t.registerBlockType)("contact-signup/form",{title:"Contact Signup Form",icon:"forms",category:"widgets",edit:()=>{const[t,a]=(0,e.useState)(""),[l,c]=(0,e.useState)(""),[s,r]=(0,e.useState)(""),[i,u]=(0,e.useState)(""),[m,d]=(0,e.useState)([]),[p,g]=(0,e.useState)(""),[E,b]=(0,e.useState)("");return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("form",{onSubmit:async e=>{e.preventDefault(),m.length>3?g("You can only select up to 3 hobbies."):(await fetch(`${appLocalizer.apiUrl}/contact-signup/v1/contact`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":appLocalizer.nonce},body:JSON.stringify({name:t,address:l,phone:s,email:i,hobbies:m.join(", ")})})).ok?(g(""),b("Form submitted successfully!"),a(""),c(""),r(""),u(""),d([])):(g("Failed to submit the form."),b(""))}},(0,e.createElement)(n.TextControl,{label:"Name",value:t,onChange:e=>a(e),required:!0}),(0,e.createElement)(n.TextControl,{label:"Address",value:l,onChange:e=>c(e),required:!0}),(0,e.createElement)(n.TextControl,{label:"Phone",value:s,onChange:e=>r(e),required:!0}),(0,e.createElement)(n.TextControl,{label:"Email",value:i,onChange:e=>u(e),type:"email",required:!0}),(0,e.createElement)(o,{hobbies:m,setHobbies:d}),p&&(0,e.createElement)("p",{className:"error"},p),E&&(0,e.createElement)("p",{className:"success"},E),(0,e.createElement)(n.Button,{type:"submit",isPrimary:!0},"Sign Up")))},save:()=>null}),(0,t.registerBlockType)("contact-signup/block",{title:"Contact Signup Block",icon:"id",category:"widgets",attributes:{selectedContact:{type:"string",default:""}},edit:t=>{const{attributes:l,setAttributes:o}=t,[c,s]=(0,e.useState)([]),[r,i]=(0,e.useState)(!0),[u,m]=(0,e.useState)(null);(0,e.useEffect)((()=>{const e=`${appLocalizer.apiUrl}/contact-signup/v1/contacts`;fetch(e).then((e=>e.json())).then((e=>{console.log("Fetched Contacts:",e),s(e),i(!1);const t=e.find((e=>e.id===l.selectedContact));m(t||null),console.log("Initial Contact Data:",t)})).catch((e=>{console.error("Error fetching contacts:",e),i(!1)}))}),[]),(0,e.useEffect)((()=>{if(c.length>0){const e=c.find((e=>e.id===l.selectedContact));m(e||null),console.log("Selected Contact Data Updated:",e)}}),[l.selectedContact,c]);const d=c.map((e=>({label:e.name,value:e.id})));return(0,e.createElement)(e.Fragment,null,(0,e.createElement)(a.InspectorControls,null,(0,e.createElement)(n.PanelBody,{title:"Contact Settings"},r?(0,e.createElement)("p",null,"Loading contacts..."):0===c.length?(0,e.createElement)("p",null,"No contacts found."):(0,e.createElement)(n.SelectControl,{label:"Select a Contact",value:l.selectedContact,options:[{label:"Select a contact",value:""},...d],onChange:e=>{o({selectedContact:e});const t=c.find((t=>t.id===e));m(t||null),console.log("Select Change - Contact ID:",e),console.log("Select Change - Contact Data:",t)}}))),(0,e.createElement)("div",{className:"contact-card-wrapper"},u?(0,e.createElement)("div",{className:"contact-card"},(0,e.createElement)("h2",null,u.name),(0,e.createElement)("p",null,"Address: ",u.address),(0,e.createElement)("p",null,"Phone: ",u.phone),(0,e.createElement)("p",null,"Email: ",u.email),(0,e.createElement)("p",null,"Hobbies: ",u.hobbies)):(0,e.createElement)("p",null,"Select a contact to see details.")))},save:()=>null})}();